# Оперативное расследование: Write-up

Таск недвусмысленно намекает на то, что что-то с флагом открыто на компе у Петра, 
который заблокирован в предоставленном снапшоте. Заметим, что в снапшоте выполнен
вход в аккаунт Peter Pwner, но он заблокирован.

Сбросить пароль не выйдет, ведь так мы потеряем текущее состояние компьютера. Зато
мы можем сдампить оперативную память всей виртуальной машины, и поиграться с ней:

    vboxmanage debugvm boss dumpvmcore --filename eto.mem

(возможно, придется указать полный путь до `vboxmanage`)

Теперь есть два способа. Простой — запустить утилиту `strings` на дампе и посмотреть
текстовые строки, встречающиеся в дампе. Среди них найдется странная команда из баша,
которая нам и нужна. Но этот способ неинтересный и неочевидный.

Сложный способ заключается в том, что, оказывается, образы оперативной памяти можно
некоторым образом анализировать. Для этого, в частности, используют известный 
фреймворк [Volatility](https://www.volatilityfoundation.org/). Совершенно случайно
организаторы приложили архив `Lubuntu1804.zip`, в котором есть файлы `module.dwarf`
и `boot/System.map-4.15.0-20-generic`, по названиям которых и находится этот самый
фреймворк с подробнейшими инструкциями по использованию.

Копируем архив в директорию с профилями, с помощью ключа `--info` выясняем, что 
профиль назвался `LinuxLubuntu1804x64`. Наконец, посмотрим список запущенных процессов:

```
# volatility -f eto.mem --profile LinuxLubuntu1804x64 linux_pslist
Offset             Name                 Pid             PPid            Uid             Gid    DTB                Start Time
------------------ -------------------- --------------- --------------- --------------- ------ ------------------ ----------
<...>
0xffff9eb85e4bdc00 gvfsd-trash          977             818             1000            1000   0x0000000000036000 2019-04-19 16:44:40 UTC+0000
0xffff9eb85626ae00 lxterminal           1003            837             1000            1000   0x000000001e3f8000 2019-04-19 16:44:46 UTC+0000
0xffff9eb85dd24500 bash                 1006            1003            1000            1000   0x0000000010850000 2019-04-19 16:44:46 UTC+0000
0xffff9eb8561f8000 Xorg                 1064            583             0               0      0x0000000011b30000 2019-04-19 16:45:39 UTC+0000
0xffff9eb850af4500 lightdm              1076            583             0               0      0x0000000019934000 2019-04-19 16:45:39 UTC+0000
0xffff9eb85ab9ae00 (sd-pam)             1080            1079            106             113    0x0000000001978000 2019-04-19 16:45:39 UTC+000
<...>
```

Из интересного видим баш, запущенный юзером 1000 (это Пётр). Больше ничего интересного в
списке процессов не видно (кроме `ssh-agent`'а, но он пустой). Что ж, для анализа баша 
есть специальный плагин `linux_bash`:

```
# volatility -f eto.mem --profile=LinuxLubuntu1804x64 linux_bash
Volatility Foundation Volatility Framework 2.6
Pid      Name                 Command Time                   Command
-------- -------------------- ------------------------------ -------
    1006 bash                 2019-04-19 16:45:02 UTC+0000   echo "ZmxhZyAyOiB1Z3JhX2IxZ19kdW1wXzE1X2cwMGQK" | base64 -d > /dev/null
4?$ 1006 bash                 2019-04-19 16:45:02 UTC+0000   H?H?
```

Делаем ровно то, что в команде, но не выводим в `/dev/null`. Получаем флаг.

Флаг: **ugra_b1g_dump_15_g00d**
